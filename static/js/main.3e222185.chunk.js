(this.webpackJsonpdocvision=this.webpackJsonpdocvision||[]).push([[0],{29:function(e,t,n){},30:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(0),r=n.n(c),i=n(22),l=n.n(i),o=(n(29),n(30),n(6)),s=function(e){var t=e.to,n=e.text;return Object(a.jsx)(o.b,{className:"menu__item",to:t,children:n})},u=function(){return Object(a.jsx)("div",{className:"menu__logo",children:"MENU LOGO"})},d=function(){return Object(a.jsxs)("div",{className:"menu",children:[Object(a.jsx)(u,{}),Object(a.jsx)(s,{text:"\u041f\u043e\u043c\u0435\u0449\u0435\u043d\u0438\u044f",to:"/places"}),Object(a.jsx)(s,{text:"\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435",to:"/inventory"})]})},_=function(){return Object(a.jsxs)("div",{className:"layout__header",children:[Object(a.jsxs)("div",{className:"layout__header__search",children:[Object(a.jsx)("span",{className:"material-icons",children:"search"}),Object(a.jsx)("input",{className:"layout__header__search__input",type:"text"})]}),Object(a.jsxs)("div",{className:"layout__header__profile",children:[Object(a.jsx)("span",{className:"material-icons",children:"perm_identity"}),Object(a.jsx)("span",{children:"Profile"})]})]})},j=n(14),p=n(2),f=n.n(p),v=n(3),m=n(9),b=n(4),h=function e(t){var n,c=t.place,r=t.getPlace;return Object(a.jsx)(a.Fragment,{children:(null===(n=c.parts)||void 0===n?void 0:n.length)>0?Object(a.jsxs)("div",{className:"layout__content__place",children:[Object(a.jsx)("div",{className:"layout__content__place__main",children:c.data.name}),Object(a.jsx)("ul",{className:"layout__content__place__parts",children:c.parts.map((function(t){var n,c;return Object(a.jsx)("li",{children:(null===(n=r(t))||void 0===n?void 0:n.parts)?Object(a.jsx)(e,{place:r(t),getPlace:r}):Object(a.jsx)(o.b,{to:"/place/".concat(t),children:null===(c=r(t))||void 0===c?void 0:c.data.name})},t)}))})]}):null})},x=function(e){var t=e.placesData,n=function e(n){var a=t.places.find((function(e){return e.id===n}));return(null===a||void 0===a?void 0:a.parts)&&a.parts.forEach((function(t){return e(t)})),a};return Object(a.jsx)("div",{className:"layout__content__places",children:null===t||void 0===t?void 0:t.places.filter((function(e){return"main"===e.id||"production"===e.id})).map((function(e){return Object(a.jsx)(h,{place:e,getPlace:n},e.id)}))})},O={getPlaces:function(){var e=Object(v.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,firebase.firestore().collection("places").get().then((function(e){return e.docs.map((function(e){return{id:e.id,data:e.data(),parts:e.data().parts&&e.data().parts.map((function(e){return e.id}))}}))}));case 2:return t=e.sent,e.abrupt("return",{places:t});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getInventory:function(){var e=Object(v.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,firebase.firestore().collection("inventory").get().then((function(e){return e.docs.map((function(e){var t;if(e.data().place)return{id:e.id,data:e.data(),placeId:null===(t=e.data())||void 0===t?void 0:t.place.id}}))}));case 2:return t=e.sent,e.abrupt("return",{inventory:t.filter((function(e){return e}))});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),addNewInventory:function(){var e=Object(v.a)(f.a.mark((function e(t){var n,a,c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=t.count,c=t.placeId,r=firebase.firestore(),e.next=4,r.collection("inventory").doc().set({name:n,count:a,place:r.collection("places").doc("".concat(c))}).then((function(){console.info("Done")}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateInventory:function(){var e=Object(v.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,firebase.firestore().collection("inventory").doc("".concat(t)).set({count:n}).then((function(){console.info("Done")}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteInventory:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,firebase.firestore().collection("inventory").doc(t).delete().then((function(){console.info("Done")}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},y=function(e){var t=e.match.params.id,n=function(e){var t=Object(c.useState)({loading:!0,placesData:null}),n=Object(m.a)(t,2),a=n[0],r=a.placesData,i=a.loading,l=n[1];return Object(c.useEffect)((function(){!function(){var e=Object(v.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getPlaces();case 2:(t=e.sent)&&l({placesData:t,loading:!1});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),{place:null===r||void 0===r?void 0:r.places.find((function(t){return t.id===e})),loading:i}}(t),r=n.place,i=n.loading,l=function(e){var t=Object(c.useState)(),n=Object(m.a)(t,2),a=n[0],r=n[1];return Object(c.useEffect)((function(){!function(){var e=Object(v.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getInventory();case 2:t=e.sent,n=t.inventory,r({inventory:n});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),null===a||void 0===a?void 0:a.inventory.filter((function(t){return t.placeId===e}))}(t);return i?Object(a.jsx)("div",{children:"Loading"}):Object(a.jsxs)("div",{className:"layout__content__view-place",children:[Object(a.jsx)("h1",{children:null===r||void 0===r?void 0:r.data.name}),Object(a.jsx)("ul",{children:null===l||void 0===l?void 0:l.map((function(e){return Object(a.jsx)("li",{children:e.data.name},e.id)}))}),Object(a.jsxs)(o.b,{to:"/inventory/add-new/data?placeId=".concat(null===r||void 0===r?void 0:r.id),className:"add-link",children:[Object(a.jsx)("span",{className:"material-icons",children:"add"}),Object(a.jsx)("span",{className:"add-link__text",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435"})]})]})},N=function(e){var t=e.inventory,n=e.place,c=e.deleteInventory;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h1",{children:t.data.name}),Object(a.jsxs)("div",{className:"layout__content__inventorys__items__item__description",children:[Object(a.jsx)("div",{children:Object(a.jsxs)(o.b,{to:"/place/".concat(n.id),children:["\u041c\u0435\u0441\u0442\u043e \u043d\u0430\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f: ",n.data.name]})}),Object(a.jsxs)("span",{children:["\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e: ",t.data.count]})]}),Object(a.jsx)(o.b,{to:"/inventory/add-new/data?placeId=".concat(n.id,"&inventoryId=").concat(t.id),children:Object(a.jsx)("button",{children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),Object(a.jsx)("button",{onClick:function(){return c(t.id)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})},g=function(e){var t=e.placesData,n=e.inventoryData,c=e.deleteInventory;return Object(a.jsxs)("div",{className:"layout__content__inventorys",children:[Object(a.jsx)("ul",{className:"layout__content__inventorys__items",children:null===n||void 0===n?void 0:n.inventory.map((function(e){var n=null===t||void 0===t?void 0:t.places.find((function(t){return t.id===e.placeId}));return Object(a.jsx)("li",{className:"layout__content__inventorys__items__item",children:Object(a.jsx)(N,{inventory:e,place:n,deleteInventory:c})},e.id)}))}),Object(a.jsxs)(o.b,{to:"/inventory/add-new/",className:"add-link",children:[Object(a.jsx)("span",{className:"material-icons",children:"add"}),Object(a.jsx)("span",{className:"add-link__text",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435"})]})]})},w=n(17),I=function(e){var t,n,c,r,i,l=e.currentPlace,o=e.placesData,s=Object(w.a)(),u=s.register,d=s.handleSubmit,_=s.errors,p=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.addNewInventory(Object(j.a)({},t));case 2:window.location.href="/inventory";case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("form",{className:"layout__content__form",onSubmit:d(p),children:[Object(a.jsxs)("div",{className:"layout__content__form__field",children:[Object(a.jsx)("span",{className:"layout__content__form__field__title",children:" \u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f "}),Object(a.jsx)("input",{className:"layout__content__form__field__input",name:"name",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",ref:u({required:!0,maxLength:50})}),"required"===(null===(t=_.name)||void 0===t?void 0:t.type)?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"}):null,"maxLength"===(null===(n=_.name)||void 0===n?void 0:n.type)?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043c\u043d\u043e\u0433\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}):null]}),Object(a.jsxs)("div",{className:"layout__content__form__field",children:[Object(a.jsx)("span",{className:"layout__content__form__field__title",children:" \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0435\u0434\u0438\u043d\u0438\u0446 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f "}),Object(a.jsx)("input",{className:"layout__content__form__field__input",name:"count",placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0435\u0434\u0438\u043d\u0438\u0446 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",ref:u({required:!0,pattern:/\d/,validate:function(e){return parseInt(e)>0&&parseInt(e)<=100}})}),"required"===(null===(c=_.count)||void 0===c?void 0:c.type)?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"}):null,"pattern"===(null===(r=_.count)||void 0===r?void 0:r.type)?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u0414\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0446\u0438\u0444\u0440\u044b"}):null,"validate"===(null===(i=_.count)||void 0===i?void 0:i.type)?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"}):null]}),Object(a.jsxs)("div",{className:"layout__content__form__field",children:[Object(a.jsx)("span",{className:"layout__content__form__field__title",children:" \u041c\u0435\u0441\u0442\u043e\u043d\u0430\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0435 "}),Object(a.jsxs)("select",{className:"layout__content__form__field__select",name:"placeId",placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043c\u0435\u0441\u0442\u043e\u043d\u0430\u0445\u043e\u0434\u0435\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",defaultValue:(null===l||void 0===l?void 0:l.id)||"default",ref:u({required:!0}),children:[Object(a.jsx)("option",{value:"",disabled:!0,children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u043c\u0435\u0449\u0435\u043d\u0438\u0435"}),null===o||void 0===o?void 0:o.places.map((function(e){return e.parts?null:Object(a.jsx)("option",{value:e.id,children:e.data.name},e.id)}))]}),_.placeId?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"}):null]}),Object(a.jsx)("button",{className:"button",type:"submit",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]})},D=function(e){var t,n,c,r,i,l=e.currentPlace,o=e.currentInventory,s=e.placesData,u=Object(w.a)(),d=u.register,_=u.handleSubmit,j=u.errors,p=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.updateInventory(o.id,t.count);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("form",{className:"layout__content__form",onSubmit:_(p),children:[Object(a.jsxs)("div",{className:"layout__content__form__field",children:[Object(a.jsx)("span",{className:"layout__content__form__field__title",children:" \u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f "}),Object(a.jsx)("input",{className:"layout__content__form__field__input",name:"name",defaultValue:o.data.name,ref:d({required:!0,maxLength:50})}),"required"===(null===(t=j.name)||void 0===t?void 0:t.type)?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"}):null,"maxLength"===(null===(n=j.name)||void 0===n?void 0:n.type)?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043c\u043d\u043e\u0433\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}):null]}),Object(a.jsxs)("div",{className:"layout__content__form__field",children:[Object(a.jsx)("span",{className:"layout__content__form__field__title",children:" \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0435\u0434\u0438\u043d\u0438\u0446 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f "}),Object(a.jsx)("input",{className:"layout__content__form__field__input",name:"count",defaultValue:o.data.count,ref:d({required:!0,pattern:/\d/,validate:function(e){return parseInt(e)>0&&parseInt(e)<=100}})}),"required"===(null===(c=j.count)||void 0===c?void 0:c.type)?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"}):null,"pattern"===(null===(r=j.count)||void 0===r?void 0:r.type)?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u0414\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0446\u0438\u0444\u0440\u044b"}):null,"validate"===(null===(i=j.count)||void 0===i?void 0:i.type)?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"}):null]}),Object(a.jsxs)("div",{className:"layout__content__form__field",children:[Object(a.jsx)("span",{className:"layout__content__form__field__title",children:" \u041c\u0435\u0441\u0442\u043e\u043d\u0430\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0435 "}),Object(a.jsxs)("select",{className:"layout__content__form__field__select",name:"placeId",placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043c\u0435\u0441\u0442\u043e\u043d\u0430\u0445\u043e\u0434\u0435\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",defaultValue:l.id||"default",ref:d({required:!0}),children:[Object(a.jsx)("option",{value:"",disabled:!0,children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u043c\u0435\u0449\u0435\u043d\u0438\u0435"}),s.places.map((function(e){return e.parts?null:Object(a.jsx)("option",{value:e.id,children:e.data.name},e.id)}))]}),j.placeId?Object(a.jsx)("span",{className:"layout__content__form__field__error",children:"\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"}):null]}),Object(a.jsx)("button",{className:"button",type:"submit",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})},k=function(e){var t=e.placesData,n=e.inventoryData,c=new URLSearchParams(Object(b.e)().search).get("placeId"),r=new URLSearchParams(Object(b.e)().search).get("inventoryId"),i=c?null===t||void 0===t?void 0:t.places.find((function(e){return e.id===c})):null,l=r?null===n||void 0===n?void 0:n.inventory.find((function(e){return e.id===r})):null;return l?Object(a.jsx)(D,{placesData:t,currentPlace:i,currentInventory:l}):Object(a.jsx)(I,{placesData:t,currentPlace:i})},P=function(){var e=Object(c.useState)({placesData:null,inventoryData:null,loading:!0}),t=Object(m.a)(e,2),n=t[0],r=n.placesData,i=n.inventoryData,l=n.loading,o=t[1];Object(c.useEffect)((function(){(function(){var e=Object(v.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.getPlaces();case 2:return t=e.sent,e.next=5,O.getInventory();case 5:n=e.sent,t&&n&&o({placesData:t,inventoryData:n,loading:!1});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),console.log("effect")}),[]);var s=function(){var e=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o({placesData:null,inventoryData:null,loading:!0}),n=null===i||void 0===i?void 0:i.inventory.findIndex((function(e){return e.id===t})),null===i||void 0===i||i.inventory.splice(n,1),e.next=5,O.deleteInventory(t);case 5:o({placesData:r,inventoryData:i,loading:!1});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return l?Object(a.jsx)("div",{children:"Loading"}):Object(a.jsxs)("div",{className:"layout__content",children:[Object(a.jsx)(b.a,{exact:!0,path:"/places",children:Object(a.jsx)(x,{placesData:r})}),Object(a.jsx)(b.a,{exact:!0,path:"/place/:id",render:function(e){return Object(a.jsx)(y,Object(j.a)({},e))}}),Object(a.jsx)(b.a,{exact:!0,path:"/inventory",children:Object(a.jsx)(g,{placesData:r,inventoryData:i,deleteInventory:s})}),Object(a.jsx)(b.a,{path:"/inventory/add-new",render:function(e){return Object(a.jsx)(k,Object(j.a)(Object(j.a)({},e),{},{placesData:r,inventoryData:i}))}})]})};var q=function(){return Object(a.jsx)(o.a,{children:Object(a.jsxs)("div",{className:"app",children:[Object(a.jsx)(d,{}),Object(a.jsxs)("div",{className:"layout",children:[Object(a.jsx)(_,{}),Object(a.jsx)(P,{})]})]})})};l.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(q,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.3e222185.chunk.js.map